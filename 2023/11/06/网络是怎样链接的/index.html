<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>计网 - 网络是怎样连接的 | 个人主页</title><meta name="author" content="陈锴烺"><meta name="copyright" content="陈锴烺"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="网络是怎样连接的探索浏览器内容生成HTTP请求消息URL(uniform resource locator)统一资源定位符FTP (file transfer protocol)文件传送协议HTTP(hypertext transfor protocol) 超文本传送协议TCP（transmission control protocol）传输控制协议UDP（user datagram protoc">
<meta property="og:type" content="article">
<meta property="og:title" content="计网 - 网络是怎样连接的">
<meta property="og:url" content="https://forthdifferential.github.io/2023/11/06/%E7%BD%91%E7%BB%9C%E6%98%AF%E6%80%8E%E6%A0%B7%E9%93%BE%E6%8E%A5%E7%9A%84/index.html">
<meta property="og:site_name" content="个人主页">
<meta property="og:description" content="网络是怎样连接的探索浏览器内容生成HTTP请求消息URL(uniform resource locator)统一资源定位符FTP (file transfer protocol)文件传送协议HTTP(hypertext transfor protocol) 超文本传送协议TCP（transmission control protocol）传输控制协议UDP（user datagram protoc">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://forthdifferential.github.io/imgs/$%7Bfiilename%7D/%E7%BD%91%E7%BB%9C%E6%98%AF%E6%80%8E%E6%A0%B7%E8%BF%9E%E6%8E%A5%E7%9A%84/net_title.png">
<meta property="article:published_time" content="2023-11-06T08:11:26.292Z">
<meta property="article:modified_time" content="2023-11-14T13:20:51.090Z">
<meta property="article:author" content="陈锴烺">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://forthdifferential.github.io/imgs/$%7Bfiilename%7D/%E7%BD%91%E7%BB%9C%E6%98%AF%E6%80%8E%E6%A0%B7%E8%BF%9E%E6%8E%A5%E7%9A%84/net_title.png"><link rel="shortcut icon" href="/imgs/head.ico"><link rel="canonical" href="https://forthdifferential.github.io/2023/11/06/%E7%BD%91%E7%BB%9C%E6%98%AF%E6%80%8E%E6%A0%B7%E9%93%BE%E6%8E%A5%E7%9A%84/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '计网 - 网络是怎样连接的',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-11-14 21:20:51'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/imgs/head.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">11</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="个人主页"><span class="site-name">个人主页</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">计网 - 网络是怎样连接的</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-11-06T08:11:26.292Z" title="发表于 2023-11-06 16:11:26">2023-11-06</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-11-14T13:20:51.090Z" title="更新于 2023-11-14 21:20:51">2023-11-14</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">计算机网络</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">6.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>20分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="计网 - 网络是怎样连接的"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><article class="post-content" id="article-container"><h1 id="网络是怎样连接的"><a href="#网络是怎样连接的" class="headerlink" title="网络是怎样连接的"></a>网络是怎样连接的</h1><h2 id="探索浏览器内容"><a href="#探索浏览器内容" class="headerlink" title="探索浏览器内容"></a>探索浏览器内容</h2><h3 id="生成HTTP请求消息"><a href="#生成HTTP请求消息" class="headerlink" title="生成HTTP请求消息"></a>生成HTTP请求消息</h3><p>URL(uniform resource locator)统一资源定位符<br>FTP (file transfer protocol)文件传送协议<br>HTTP(hypertext transfor protocol) 超文本传送协议<br>TCP（transmission control protocol）传输控制协议<br>UDP（user datagram protocol）用户数据报协议<br>IP（internet protocol）网络互联协议</p>
<p>浏览器是综合性的客户端软件，需要不同的URL来判断使用哪个功能<br>URL开头部分指明了访问方法	(协议	)；</p>
<h4 id="HTTP定义了客户端与服务器之间交互的消息内容和步骤："><a href="#HTTP定义了客户端与服务器之间交互的消息内容和步骤：" class="headerlink" title="HTTP定义了客户端与服务器之间交互的消息内容和步骤："></a>HTTP定义了客户端与服务器之间交互的<strong>消息内容</strong>和<strong>步骤</strong>：</h4><p>内容包括：<br>URI(identifier)：存放网页数据的文件名或者CGI程序的文件名	<br>其中CGI(common gateway iterface)通用网关接口 ：web服务器调用其他程序的规则<br>方法：<br>GET POST HEAD OPTIONS PUT DELETE TRACE CONNECT</p>
<p>Web服务器对其中内容进行解析，完成工作后，结果存放在响应消息中，包括状态码、头字段、网页数据</p>
<h3 id="向DNS服务器查询Web服务器的IP地址"><a href="#向DNS服务器查询Web服务器的IP地址" class="headerlink" title="向DNS服务器查询Web服务器的IP地址"></a>向DNS服务器查询Web服务器的IP地址</h3><p>TCP&#x2F;IP结构 用集线器链接的计算机形成子网，通过路由器连接成一个大的网络；<br>数据以包的形式传送；</p>
<p>IP地址： 网络号和主机号；共32位，8比特为一组，十进制表示，圆点隔开；<br>子网掩盖码：写在IP地址右侧，表示IP地址的结构，也可以用网络号的位数表示‘</p>
<p>DNS(dommain name system)域名服务器系统：用于为各种信息关联相应的名称；<br>DNS解析器用于域名解析，包含在 操作系统的Socket库（操作系统中用于调用网络功能的程序组件几何）中；</p>
<h3 id="DNS服务器大接力"><a href="#DNS服务器大接力" class="headerlink" title="DNS服务器大接力"></a>DNS服务器大接力</h3><p>控制流程转移；web浏览器——》Socket向DNS查询IP地址——》操作系统内部协议栈；</p>
<p>DNS接受客户端的查询信息：域名  、Class 、记录类型（A表示IP地址，MX表示邮件服务器）；</p>
<h4 id="域名层次结构："><a href="#域名层次结构：" class="headerlink" title="域名层次结构："></a>域名层次结构：</h4><ol>
<li>内部网络服务器数量有限的情况下，可以都保存在一台DNS服务器中；</li>
<li>多台DNS服务器接力,分层次从后往前缩小，最下层的www为服务器名<br>com的上一层为根域，写法可以省略，根域的IP地址只有13个且不变，一般已经配置在DNS服务器程序中了</li>
</ol>
<h4 id="客户端查询过程："><a href="#客户端查询过程：" class="headerlink" title="客户端查询过程："></a>客户端查询过程：</h4><p>最近的DNS服务器——》没有则从根目录自顶向下查找；<br>如果有域名缓存，可以从缓存位置向下查找；</p>
<p>缓存：使用过的数据存放在离使用该数据较近的高速存储装置中，以提高后续访问速度</p>
<h4 id="收发数据的操作："><a href="#收发数据的操作：" class="headerlink" title="收发数据的操作："></a>收发数据的操作：</h4><ul>
<li>1.创建套接字（调用socket）、2.接管道连接到服务器端的套接字上、3.收发数据、4.断开管道并删除套接字；</li>
</ul>
<ol>
<li>创建套接字完成后系统返回 <strong>描述符</strong>，应用程序通过描述符来识别套接字；</li>
<li>connect连接用到：描述符（应用程序用来识别套接字的机制）、服务器IP地址、端口号（这两个是服务器和客户端实现互相识别对方套接字的机制）</li>
<li>write和read：接收缓存区</li>
<li>close：客户端和服务器一端先断开，然后断开操作传到另一端</li>
</ol>
<h2 id="用电信号传输TCP-x2F-IP数据——协议栈和网卡"><a href="#用电信号传输TCP-x2F-IP数据——协议栈和网卡" class="headerlink" title="用电信号传输TCP&#x2F;IP数据——协议栈和网卡"></a>用电信号传输TCP&#x2F;IP数据——协议栈和网卡</h2><p><img src="/imgs/$%7Bfiilename%7D/%E7%BD%91%E7%BB%9C%E6%98%AF%E6%80%8E%E6%A0%B7%E8%BF%9E%E6%8E%A5%E7%9A%84/image-20220908192019506.png" alt="image-20220908192019506"></p>
<h3 id="创建套接字"><a href="#创建套接字" class="headerlink" title="创建套接字"></a>创建套接字</h3><p>应用程序——Socket库和解析器——<em>操作系统中的TCP、UDP、IP</em>——网卡驱动程序——硬件网卡</p>
<p>浏览器、邮件等一般应用程序收发数据时用TCP，DNS查询等收发较短的控制数据时用UDP；<br>网络包：网络中数据的小包（几十到几千字节）；<br>IP协议将网络包发送给通信对象</p>
<p>套接字作用：记录了用于控制通信操作的各种控制信息，协议栈根据这些信息判断下一步的行动；<br>processID：操作系统为了标识应用程序分配的编号；</p>
<p>应用程序调用socket创建套接字，协议栈首先分配内存空间，然后写入初始状态，返回描述符给应用程序</p>
<h3 id="连接服务器"><a href="#连接服务器" class="headerlink" title="连接服务器"></a>连接服务器</h3><p>TCP头部大概有<strong>双方的端口号、初始序号、窗口大小、ACK号、校验、头部长度、控制位</strong>等信息</p>
<p><img src="/imgs/$%7Bfiilename%7D/%E7%BD%91%E7%BB%9C%E6%98%AF%E6%80%8E%E6%A0%B7%E8%BF%9E%E6%8E%A5%E7%9A%84/image-20220908193526768.png" alt="image-20220908193526768"></p>
<p>连接：通信双方交换控制信息，在套接字中记录这些信息并准备数据收发的一连串操作；<br>控制信息：头部中记录的信息和套接字中记录的信息<br>A发送SYN为1的TCP包、创建数据的初始序号、需要的窗口大小——》B返回SYN为1的TCP包、初始序号、窗口大小、返回收到包的ACK号——》B返回收到的ACK号</p>
<p>TCP模块创建连接控制信息的头部——》找到套接字	——》修改状态为正在连接</p>
<h3 id="收发数据"><a href="#收发数据" class="headerlink" title="收发数据"></a>收发数据</h3><p>应用程序调用write将数据交给给协议栈，协议栈执行发送操作；</p>
<ul>
<li>积累多少数据发送出去判断标准:<strong>1,MTU 2,时间</strong><br>MTU（maximum transmission unit）最大传输单元：每个<strong>网络包</strong>所能容纳的最大长度；一般是1500字节<br>MSS（maximum segment size）最大分段大小：MTU减去头部的长度；也就是实际缓冲区能放的数据量<br>时间主要是看频率，协议栈内部有一个计时器；</li>
</ul>
<ol>
<li>以上两个要素时矛盾的，需要综合考虑，可以指定直接发送</li>
<li>数据块较大的需要按照MSS拆分</li>
</ol>
<ul>
<li><p>序号和ACK号使用方法——<strong>确认对方是否收到网络包</strong>：<br>连接时将SYN设置为1，并告知初始序号；<br>计算数据长度后发送ACK号，并设置比特为1，表示ACK号有效<br>在返回ACK号确认之前，包都保存在缓冲区，可以重写发送</p>
</li>
<li><p>客户端和服务器端双向传输过程</p>
</li>
<li><p>网络的错误检测和补偿机制非常复杂；</p>
</li>
<li><ol>
<li>按照ACK返回时间动态调整等待时间；</li>
<li>滑动窗口管理ACK：接收方通过TCP头部的窗口字段将缓冲区余量告知发送方；发送方在等待ACK返回时继续发送下一个包，但需要在缓冲区余量内。<br>最大数据量称为<strong>窗口大小</strong>：一般就是接收方缓冲区的大小</li>
<li>ACK和窗口合并，多个ACK时只需要发最后一个以告知接收数据的最后位置——都是为了减少包</li>
</ol>
</li>
<li><p><strong>协议栈接受数据的基本操作</strong>：检查收到的数据库和TCP头部，没有数据确实则返回ACK，将数据放在缓存区，数据拼接为原始数据并交给应用程序（复制到程序的内存空间），最后向发送方发送窗口更新</p>
</li>
</ul>
<h3 id="服务器断开并删除套接字"><a href="#服务器断开并删除套接字" class="headerlink" title="服务器断开并删除套接字"></a>服务器断开并删除套接字</h3><p>例子：服务器端调用Socket库中close程序，协议栈生成包含断开的TCP头部（控制为<strong>FIN设为1</strong>），委托IP模块向客户端发送数据，同时服务端套接字记入断开信息；客户端收到收到TCP头部，协议栈将套接字进入断开状态，并返回给服务器端<strong>ACK号</strong>；协议栈就可以等应用程序取数据了。应用程序read数据，这是协议栈告知应用程序数据收到完成。客户端应用close关闭生成<strong>FIN为1</strong>发送为服务端，服务端<strong>返回ACK</strong>，通信结束。</p>
<ul>
<li>删除套接字：需要等待时间以方便重新发送FIN</li>
</ul>
<p>总结TCP整体流程：</p>
<p><img src="/imgs/$%7Bfiilename%7D/%E7%BD%91%E7%BB%9C%E6%98%AF%E6%80%8E%E6%A0%B7%E8%BF%9E%E6%8E%A5%E7%9A%84/image-20220908104715535.png" alt="总结TCP整体流程"></p>
<h3 id="IP和以太网的包收发操作"><a href="#IP和以太网的包收发操作" class="headerlink" title="IP和以太网的包收发操作"></a>IP和以太网的包收发操作</h3><p>mac头部——集线器——子网中的以太网协议（可以更换成其他网络如无线局域网）<br><strong>凡是局域网使用的头部豆角MAC头</strong></p>
<p>IP头部——IP协议——路由器</p>
<p><img src="/imgs/$%7Bfiilename%7D/%E7%BD%91%E7%BB%9C%E6%98%AF%E6%80%8E%E6%A0%B7%E8%BF%9E%E6%8E%A5%E7%9A%84/image-20220908193611154.png" alt="image-20220908193611154"></p>
<p><img src="/imgs/$%7Bfiilename%7D/%E7%BD%91%E7%BB%9C%E6%98%AF%E6%80%8E%E6%A0%B7%E8%BF%9E%E6%8E%A5%E7%9A%84/image-20220908193629305.png" alt="image-20220908193629305"></p>
<h4 id="包收发操作"><a href="#包收发操作" class="headerlink" title="包收发操作"></a>包收发操作</h4><ol>
<li>IP模块（包传输过程的入口）：TCP模块委托IP模块发送包，即加上IP头，MAC头，包就封装好了；</li>
<li>封装好的包交给硬件网卡，将数字信息转换为光电信息，通过集线器、路由器等传递到接收方；</li>
<li>接收方拿到后做出相应，返回的包被转换为数字信息，加上TCP头部</li>
</ol>
<p><img src="/imgs/$%7Bfiilename%7D/%E7%BD%91%E7%BB%9C%E6%98%AF%E6%80%8E%E6%A0%B7%E8%BF%9E%E6%8E%A5%E7%9A%84/image-20220908145444278.png" alt="image-20220908145444278"></p>
<p>Gateway网关：在TCP&#x2F;IP中指的是路由器；<br>通过路由表来匹配该把包发给哪个网卡的IP地址；</p>
<h4 id="以太网内MAC地址查询："><a href="#以太网内MAC地址查询：" class="headerlink" title="以太网内MAC地址查询："></a>以太网内MAC地址查询：</h4><p>ARP（address resolution protocol）地址解析协议：一种地址广播的方法，能返回子网内相应IP地址的MAC地址；</p>
<p>MAC地址长度为48比特，IP地址长度32比特，也就是6部分，一字节一部分，用-或者：分开，十进制和十六进制表示；<br>media access control</p>
<p>目前常用的是交换式集线器：信号会更具MAC地址流到指定的设备	</p>
<ul>
<li><p>以太网特性：</p>
<ol>
<li>将包发送到MAC头的接收方MAC地址所代表的的目的地；</li>
<li>用发送方的MAC地址识别发送方；</li>
<li>用以太类型识别包类型</li>
</ol>
<p>说明：无线局域网也有1和2的特点，所以用来替代以太网</p>
</li>
</ul>
<h4 id="网卡将IP包转化成光电信号（没看）"><a href="#网卡将IP包转化成光电信号（没看）" class="headerlink" title="网卡将IP包转化成光电信号（没看）"></a>网卡将IP包转化成光电信号（没看）</h4><p>网卡中的ROM保存唯一的MAC地址，生产时就写入的，网卡驱动初始化后生效；</p>
<p>返回接收包：对应MAC地址的包放入缓存区——》产生中断信号，中断控制器，CPU暂时挂起切换到中断程序——》调用网卡驱动执行操作<br>——》从缓冲区中取出包，通过MAC头部中以太类型判断包类型（协议类型）</p>
<p>接收——》检查IP头部——》如果不一致，返回错误ICMP（查表）</p>
<h3 id="UDP协议的收发操作"><a href="#UDP协议的收发操作" class="headerlink" title="UDP协议的收发操作"></a>UDP协议的收发操作</h3><p>TCP复杂是为了实现高效和可靠：缺失部分包的时候只需要发送出错的部分，避免了重发已经送达的包；<strong>（数组在多个包的情况）</strong></p>
<p>UDP没有连接和断开阶段，只要加上UDP头部，交给IP发送就行了；接收按照IP头部和接收方的地址，UDP头部端口号<strong>（在一个包大小范围内解决）</strong></p>
<ol>
<li>UDP只负责单纯发送，不会监控，所以协议栈也不知道有没有错误；</li>
<li>最大数据长度为IP包减去UDP头部</li>
<li>音频和视频会使用UDP，确实部分包会失真，但是用TCP要额外的几倍带宽</li>
</ol>
<h2 id="网线到网络设备——集线器、交换机、路由器"><a href="#网线到网络设备——集线器、交换机、路由器" class="headerlink" title="网线到网络设备——集线器、交换机、路由器"></a>网线到网络设备——集线器、交换机、路由器</h2><h3 id="信号在网线和集线器中传输"><a href="#信号在网线和集线器中传输" class="headerlink" title="信号在网线和集线器中传输"></a>信号在网线和集线器中传输</h3><p>每个包都是独立传输的；</p>
<p>传输过程：网卡中PHY（MAU）模块将包转化为电信号——》通过RJ-45进入双绞线——》信号流入网线——》集线器的接口；<br>（传输过程中信号会衰减，波形会失真；用<strong>双绞线</strong>来抑制衰减，阻隔噪声措施等）</p>
<p>——》集线器将信号发送给所有连接在他上面的线路（<strong>原封不动广播</strong>）</p>
<h3 id="交换机的包转发"><a href="#交换机的包转发" class="headerlink" title="交换机的包转发"></a>交换机的包转发</h3><p>PHY模块接收网线中信号转化为通用格式——》MAC模块将信号转化为数字信号——》包尾部检查FCS——》没异常所有包放到缓冲区——》查询MAC地址表(MAC地址和端口的对应表)——》将信号发送到相应的端口</p>
<ul>
<li>交换机的MAC模块不具有MAC地址</li>
<li>MAC地址表会自动维护，异常时重启交换机重置地址表就行</li>
<li>全双工模式是交换机特有，可以同时发送和接收操作</li>
<li>全&#x2F;半双工切换的问题，自动协商功能</li>
<li>交换机可以同时执行多个转发操作，转发能力强</li>
</ul>
<h3 id="路由器的包转发"><a href="#路由器的包转发" class="headerlink" title="路由器的包转发"></a>路由器的包转发</h3><p>路由器是基于IP设计，交换机是基于以太网设计</p>
<h4 id="路由器转发包过程："><a href="#路由器转发包过程：" class="headerlink" title="路由器转发包过程："></a>路由器转发包过程：</h4><p>通过委托端口接受包（取决于端口通信技术）——转发模块根据接受包的IP头部中记录接收方IP地址，在路由表中查询——》委托端口模块转发包</p>
<ul>
<li>端口模块以实际的接收方&#x2F;发送方的身份来收发网络包</li>
<li>路由器的以太网端口<strong>有MAC地址</strong>，路由器的IP端口<strong>有IP地址</strong></li>
<li>路由器的子网掩盖码值表示在匹配网络包目标地址时需要对比的比特数，有可能路由聚合合并为一个子网</li>
</ul>
<p><img src="/imgs/$%7Bfiilename%7D/%E7%BD%91%E7%BB%9C%E6%98%AF%E6%80%8E%E6%A0%B7%E8%BF%9E%E6%8E%A5%E7%9A%84/image-20220909144520902.png" alt="image-20220909144520902"></p>
<h5 id="路由器接受包"><a href="#路由器接受包" class="headerlink" title="路由器接受包"></a>路由器接受包</h5><ol>
<li>转化为数字信息，检查MAC地址是否匹配；</li>
<li>接受操作后包的MAC头部被丢弃（<strong>MAC头部的作用就是将包传递到路由器</strong>）</li>
</ol>
<h5 id="查询路由表确定输出端口"><a href="#查询路由表确定输出端口" class="headerlink" title="查询路由表确定输出端口"></a>查询路由表确定输出端口</h5><ol>
<li>按照IP头部转发，子网掩码配合IP地址，确定候选转发目标</li>
<li>最长匹配原则</li>
</ol>
<h5 id="找不到匹配路由时选择默认路由"><a href="#找不到匹配路由时选择默认路由" class="headerlink" title="找不到匹配路由时选择默认路由"></a>找不到匹配路由时选择默认路由</h5><ol>
<li>子网掩码<strong>0.0.0.0</strong>，不需要匹配，默认路由，这样配置的网关地址被称为<strong>默认网关</strong></li>
<li>在找不到其他匹配路由，选择默认路由</li>
</ol>
<h5 id="路由器相关工作"><a href="#路由器相关工作" class="headerlink" title="路由器相关工作"></a>路由器相关工作</h5><ul>
<li><p>TTL：在IP头部，表示保底有效期，经过一个路由器减1,为0就是超过有效期。<br>一般设置为64&#x2F;128，防止信息错误或者路由混乱</p>
</li>
<li><p>分片功能拆分大网络包:<br>原因：不同类型线路传输的最大包长度不同；<br>操作：用IP协议中定义的分片功能，对整个包拆分<br>前提：检查MTU，检查IP头部标志字段是否能拆</p>
</li>
</ul>
<blockquote>
<p>不同于TCP拆分，TCP是在数据拆好后放到包中，也就是一个数据块刚好是包的大小</p>
</blockquote>
<h5 id="路由器的发送操作"><a href="#路由器的发送操作" class="headerlink" title="路由器的发送操作"></a>路由器的发送操作</h5><p>判断下一个转发目标：<br>    如果网关列表内容为IP地址，该地址为下一个转发目标；<br>    网关列表为空，则IP头部中的接收方IP地址为下一个转发目标；<br>路由器也会用ARP查询下一个转发目标的MAC地址；         </p>
<h4 id="路由器和交换机"><a href="#路由器和交换机" class="headerlink" title="路由器和交换机"></a>路由器和交换机</h4><p>所说的加上MAC头，实际是上将IP包装进以太网包的数据部分，委托以太网传输数据，i.e. 路由器把包的传输工作委托给交换机；</p>
<p><strong>IP（路由器）负责将包发送给通信对象整个过程；</strong></p>
<p><strong>以太网（交换机）将包传输到下一个路由器；</strong></p>
<h3 id="路由器的附加功能"><a href="#路由器的附加功能" class="headerlink" title="路由器的附加功能"></a>路由器的附加功能</h3><p>为了解决地址不足分为<strong>私有地址(golbally unique address)，公有地址(public address)</strong></p>
<p>私有地址是公有地址还没有分配的范围</p>
<p><img src="/imgs/$%7Bfiilename%7D/%E7%BD%91%E7%BB%9C%E6%98%AF%E6%80%8E%E6%A0%B7%E8%BF%9E%E6%8E%A5%E7%9A%84/image-20220909172640673.png" alt="image-20220909172640673"></p>
<p>但是公司内部的私有地址不能和互联网直接进行通信，需要通过地址转换机制</p>
<h4 id="地址转换"><a href="#地址转换" class="headerlink" title="地址转换"></a>地址转换</h4><p>地址转换设备（路由器）</p>
<p>改写端口号，提高公有地址的利用率</p>
<h2 id="接入网和网络运营商"><a href="#接入网和网络运营商" class="headerlink" title="接入网和网络运营商"></a>接入网和网络运营商</h2><h3 id="ADSL接入网的结构和工作方式"><a href="#ADSL接入网的结构和工作方式" class="headerlink" title="ADSL接入网的结构和工作方式"></a>ADSL接入网的结构和工作方式</h3><p>互联网上万台路由器，按照接收方IP地址判断，将包转发出去；<br><strong>距离的不同和路由的维护方式</strong>不同，就是互联网与家庭、公司网络之间最初主要的两个不同点；</p>
<p>接入网：连接互联网与家庭、公司网络的通信线路（ADSL、FTTH、CATV、电话线、ISDN等）；<br>ADSL（asymmetric digital subscriber line）不对称数字用户线</p>
<p>ADSL modem 调制解调器：将包拆分成信元，并且转化为电信号发送给分离器</p>
<p><img src="/imgs/$%7Bfiilename%7D/%E7%BD%91%E7%BB%9C%E6%98%AF%E6%80%8E%E6%A0%B7%E8%BF%9E%E6%8E%A5%E7%9A%84/image-20220911135603820.png" alt="image-20220911135603820"></p>
<p><img src="/imgs/$%7Bfiilename%7D/%E7%BD%91%E7%BB%9C%E6%98%AF%E6%80%8E%E6%A0%B7%E8%BF%9E%E6%8E%A5%E7%9A%84/image-20220911140104023.png" alt="image-20220911140104023"></p>
<p>BAS（broadband access server）宽带接入服务器 ，一种<strong>路由器</strong>（不同与普通，具有身份认证，向客户端下发IP地址等配置信息的功能）：1.用户认证的窗口，2.隧道方式传输网络包</p>
<p>PPP （point to point protocol）点到点协议。电话线、ISDN等通信路线所用的一种协议</p>
<p>ATM （asynchronous transfer mode）异步传输 ，电话线为载体的通信方式，以“信元”为单位进行。</p>
<p>FTTH （Fibre (Fiber) To The Home）基于光线的接入网技术：用光纤代替ADSL将用户端接入路由器和运营商的BAS连接起来的接入方式</p>
<h4 id="分离器的作用"><a href="#分离器的作用" class="headerlink" title="分离器的作用"></a>分离器的作用</h4><p>ADSL modem将信元转化为电信号后，通过分离器，但没作用；（电话和ADSL信号同时流入线路）<br>信号从电话线传入时，分离电话和ADSL信号，防止ADSL成为电话的噪音：<br>        对于电话：分离器过滤掉高频的ADSL；<br>        对ADSL：ADSL modem内部就有信号过滤功能；<br>分离器也可以房子电话对ADSL传输方式的干扰</p>
<p>分离器——》电话线——》总配线架——》电话局——》DSLAM（转回数字信号 信元）——》BAS（将ATM信元转化为原始的包）</p>
<h3 id="光纤接入网"><a href="#光纤接入网" class="headerlink" title="光纤接入网"></a>光纤接入网</h3><p>光线的工作原理。。</p>
<h4 id="FTTH技术"><a href="#FTTH技术" class="headerlink" title="FTTH技术"></a>FTTH技术</h4><ol>
<li>直连：一种是光纤直接从用户端连接到最近的电话局：以太信号——》光信号——》DSLAM——》BAS转化为电信号，将包转发到互联网内部——》到达互联网后，服务器响应——》响应包的光信号沿着光纤返回</li>
</ol>
<p>​		光线中波分复用，区别上行和下行信号</p>
<ol start="2">
<li>分路：分光器设备，让光纤分录，同时连接多个用户：OLT和ONU避免碰撞；</li>
</ol>
<p><img src="/imgs/$%7Bfiilename%7D/%E7%BD%91%E7%BB%9C%E6%98%AF%E6%80%8E%E6%A0%B7%E8%BF%9E%E6%8E%A5%E7%9A%84/image-20220911154100876.png" alt="image-20220911154100876"></p>
<h3 id="接入网中使用的PPP和隧道"><a href="#接入网中使用的PPP和隧道" class="headerlink" title="接入网中使用的PPP和隧道"></a>接入网中使用的PPP和隧道</h3><p>PPPoE（Point to Point Protocol  over Ethernet）以太网的点对点协议：将PPP消息装入以太网包进行传输的方式；</p>
<p>包原封不动的搬运到另一端，原理上就可以看成建立隧道；</p>
<p>互联网接入路由器通过PPPoE的发现机制查询BAS的MAC地址（相当于拨号上网中拨号）</p>
<ul>
<li>地址转换：是否BAS向计算机下发了TCP&#x2F;IP配置，没下发需要在路由器中转化为公有地址</li>
</ul>
<h3 id="网络运营商的内部"><a href="#网络运营商的内部" class="headerlink" title="网络运营商的内部"></a>网络运营商的内部</h3><p>POP(Point of Presense)接入点：ADSL、FTTH等接入网的连接点，互联网的入口在这里</p>
<p>NOC（Network Operation Center）网络运行中心，（扩大版、高性能的POP）</p>
<p><img src="/imgs/$%7Bfiilename%7D/%E7%BD%91%E7%BB%9C%E6%98%AF%E6%80%8E%E6%A0%B7%E8%BF%9E%E6%8E%A5%E7%9A%84/image-20220911155250806.png" alt="image-20220911155250806"></p>
<p>按照不同类型的接入网分别使用不同类型的路由器</p>
<p><img src="/imgs/$%7Bfiilename%7D/%E7%BD%91%E7%BB%9C%E6%98%AF%E6%80%8E%E6%A0%B7%E8%BF%9E%E6%8E%A5%E7%9A%84/image-20220911160108080.png" alt="image-20220911160108080"></p>
<h3 id="跨越运营商的网络包"><a href="#跨越运营商的网络包" class="headerlink" title="跨越运营商的网络包"></a>跨越运营商的网络包</h3><p>BGP（border gateway protocol） 边界网关协议：路由信息交换的过程；</p>
<p>运营商之间所有路由器平等交换，多路判断优先级，收费；</p>
<p>IX(internet eXchange)互联网交换中心：将运营商汇聚在一起，设置中信设备，减少线路数量；具有高速以太网端口的二层交换机</p>
<p><img src="/imgs/$%7Bfiilename%7D/%E7%BD%91%E7%BB%9C%E6%98%AF%E6%80%8E%E6%A0%B7%E8%BF%9E%E6%8E%A5%E7%9A%84/image-20220911162156742.png" alt="image-20220911162156742"></p>
<h2 id="服务器端的局域网"><a href="#服务器端的局域网" class="headerlink" title="服务器端的局域网"></a>服务器端的局域网</h2><p>在服务器前部署一个防火墙：只允许发往特定服务器中的特定应用程序的包通过，屏蔽其他的包；常用的是包过滤方式</p>
<h4 id="包过滤方式（主流防火墙方式）"><a href="#包过滤方式（主流防火墙方式）" class="headerlink" title="包过滤方式（主流防火墙方式）"></a>包过滤方式（主流防火墙方式）</h4><ul>
<li>设置允许通过的<strong>接收方IP和发送方IP</strong>（注意应答机制，要回复ACK）</li>
<li>设置端口号限定应用程序，<strong>接收方端口号、发送方端口号</strong></li>
<li><strong>控制位</strong>判断连接方向（TCP头部的控制位；但是对UDP没有控制位可以设置只能公司内网访问DNS服务器，牺牲便利性）</li>
<li>对具体数据不能识别风险：一种是持续关注安全漏洞信息并更新软件的版本；一种是在防火墙之外部署用来检查包内容并阻止有害包的设备或软件。</li>
</ul>
<p>内网访问公开区域</p>
<p>外部互联网访问公司内网，默认不能访问，内网到外网的话需要地址转化</p>
<p><img src="/imgs/$%7Bfiilename%7D/%E7%BD%91%E7%BB%9C%E6%98%AF%E6%80%8E%E6%A0%B7%E8%BF%9E%E6%8E%A5%E7%9A%84/image-20220911171030839.png" alt="image-20220911171030839"></p>
<p><img src="/imgs/$%7Bfiilename%7D/%E7%BD%91%E7%BB%9C%E6%98%AF%E6%80%8E%E6%A0%B7%E8%BF%9E%E6%8E%A5%E7%9A%84/image-20220911171046135.png" alt="image-20220911171046135"></p>
<h4 id="通过将请求平均分配给多台服务器来平衡负载"><a href="#通过将请求平均分配给多台服务器来平衡负载" class="headerlink" title="通过将请求平均分配给多台服务器来平衡负载"></a>通过将请求平均分配给多台服务器来平衡负载</h4><p>服务器的访问量上升，需要增加带宽和提高服务器性能；<br>提高服务器性能可以使用多台服务器来分担负载的方法——分布式架构；<br>采用多台Web服务器，减少每台服务器的访问量；<br>用DNS按顺序循环分配多台不同的IP地址——轮询；</p>
<p>问题：1. 一台宕机了咋办——访问返回失败，尝试下一个IP<br>            2. 有些操作跨多个页面，访问服务器变化则操作无法继续</p>
<h5 id="负载均衡器"><a href="#负载均衡器" class="headerlink" title="负载均衡器"></a>负载均衡器</h5><p>用其IP地址代替Web服务器的实际地址注册到DNS服务器上；</p>
<p>操作跨多个页面时，请求发送到同一个Web服务器——》判断请求之间的相关性，在HTTP头部加入Cookie<br>其他情况需要定期采集Web服务器的CPU、内存使用率</p>
<h5 id="缓存服务器"><a href="#缓存服务器" class="headerlink" title="缓存服务器"></a>缓存服务器</h5><p>服务器按照功能划分不同服务器，缓存服务器是一台通过代理机制对数据进行缓存的服务器；<br>代理在Web服务器和客户端之间，Web服务器返回的数据保存在此版中（<strong>缓存</strong>）</p>
<p>缓存服务器注册到DNS服务器中</p>
<p>Via: 表示缓存服务器中专的</p>
<h5 id="正向代理"><a href="#正向代理" class="headerlink" title="正向代理"></a>正向代理</h5><p>缓存服务器在客户端一侧部署；用作转发过程判断是否允许访问、用作防火墙的实现；</p>
<ul>
<li><p>设置时，需要在浏览器的设置窗口的代理服务器中填写正向代理的IP地址</p>
</li>
<li><p>有代理时，客户端发送给缓存服务器的请求头不需要直接填写http:&#x2F;&#x2F;这样的完整网址</p>
</li>
</ul>
<h5 id="反向代理"><a href="#反向代理" class="headerlink" title="反向代理"></a>反向代理</h5><p>服务器端的缓存服务器，将请求消息中URI的吗，目录名与Web服务器进行关联，能转发不带完整网址的请求</p>
<h5 id="透明代理"><a href="#透明代理" class="headerlink" title="透明代理"></a>透明代理</h5><p>用包的IP头部中接收方的Ip地址判断访问服务器；</p>
<p>在消息经过时拦截</p>
<h3 id="内容分发服务"><a href="#内容分发服务" class="headerlink" title="内容分发服务"></a>内容分发服务</h3><p>缓存服务器放在客户端——降低Web服务器的负载——无法减少互联网的网络流量</p>
<p>缓存服务器放在Web服务器端——Web服务器无法控制——减少网络流量</p>
<p>缓存服务器放在互联网的边缘（集合优点，但是互联网都可以访问，部署数量需求多）——服务器运营者能控制——降低网络流量</p>
<p>内容分发服务：CDN(content delivery network) 或者叫CDS(system)<br>内容分发服务运营商：CDSP(provider)</p>
<p>提前查询路由器到各个缓存服务器的之间的距离，判断最近的</p>
<h2 id="请求到达服务器，响应返回浏览器"><a href="#请求到达服务器，响应返回浏览器" class="headerlink" title="请求到达服务器，响应返回浏览器"></a>请求到达服务器，响应返回浏览器</h2><h3 id="服务器的基本信息"><a href="#服务器的基本信息" class="headerlink" title="服务器的基本信息"></a>服务器的基本信息</h3><p>服务器和客户端的协议栈、网卡、Socket库（调用其中的程序组件不一致）等功能一致，TCP&#x2F;IP的功能统一，客户端计算机也可以用作服务器；</p>
<h5 id="服务器程序"><a href="#服务器程序" class="headerlink" title="服务器程序"></a>服务器程序</h5><p>客户端通信模块一般是与客户端一对一的关系；<br>服务器操作系统具有多任务、多线程功能，同时运行多个程序；<br>：任务作为单个程序，线程是程序的一个部分</p>
<p><img src="/imgs/$%7Bfiilename%7D/%E7%BD%91%E7%BB%9C%E6%98%AF%E6%80%8E%E6%A0%B7%E8%BF%9E%E6%8E%A5%E7%9A%84/image-20220912222625199.png" alt="image-20220912222625199"></p>
<p>服务器在调用Socket库上的区别在连接阶段：<br>客户端：用管道连接服务器端的套接字<br>服务器端：1.将套接字设置为等待连接的状态 2. 接受连接</p>
<p>套接字的确定：客户端IP地址、客户端端口号、服务器IP地址、服务器端口号；</p>
<p>使用描述符来指代套接字的原因：等待连接的套接字中没有客户端IP地址和端口号、使用描述符比较简单</p>
<h3 id="服务器接收操作"><a href="#服务器接收操作" class="headerlink" title="服务器接收操作"></a>服务器接收操作</h3><h5 id="服务器接收操作的全过程回顾"><a href="#服务器接收操作的全过程回顾" class="headerlink" title="服务器接收操作的全过程回顾"></a>服务器接收操作的全过程回顾</h5><blockquote>
<p>网卡（硬件）接收信号，转化为数字信号——》按照包尾部的帧校验符FCS来校验错误——》MAC头部检查接收方的MAC地址——》保存在网卡的缓冲区中</p>
</blockquote>
<ul>
<li>网卡的MAC模块将网络包从信号还原为数字信息，校验FCS并且存入缓冲区</li>
</ul>
<blockquote>
<p>——》CPU处理中断，网卡驱动运行，读取缓冲区的包——》根据MAC头部的以太类型判断协议种类——》调用负责处理该协议的程序（也就是TCP&#x2F;IP协议栈）</p>
</blockquote>
<ul>
<li>网卡驱动按照MAC头部判断协议类型，并且发送个相应的协议栈</li>
</ul>
<blockquote>
<p>——》达到协议栈后，IP模块检查IP头部中接收方IP地址，判断转发——》检查IP头部知道是否分片，如果分片了，现存在内存里，等组装充足后还原为原始包——》检查IP头部的协议号，06则为TCP模块，11为UDP模块</p>
</blockquote>
<ul>
<li>协议栈的IP模块检查IP头部，判断是不是发给自己的，网络包有没有呗切片，对应转发协议栈是TCP还是UDP</li>
</ul>
<blockquote>
<p> ——》TCP模块按照包的内容区别，如果是SYN为1发起连接的包——》检查包的接收方端口号有没有等待连接的套接字——》无则返回ICMP消息，有则创建套接字副本，信息写入套接字生成ACK号，生产TCP头部，委托IP模块发送给客户端——》客户端返回ACK号确认，连接完成——》服务器端及进入调用accept的暂停状态，当将新套接字的描述符转交服务器程序后，服务器恢复运行</p>
</blockquote>
<ul>
<li>TCP模块：根据收到包的发送方&#x2F;接收方的IP地址&#x2F;端口号找到对应的套接字；将数据拼接放在缓冲区；向客户端返回ACK号</li>
</ul>
<blockquote>
<p>——》服务器或者客户端发起，调用Socket库中close，TCP模块生成控制位FIN为1,发送——》客户端或服务器返回一个ACK号，生成FIN为1的TCP头部发送——》服务器或客户端返回ACK号完成</p>
</blockquote>
<ul>
<li>HTTP1.1中，客户端先发起断开；断开操作后，套接字过一段时间被删除</li>
</ul>
<p><img src="/imgs/$%7Bfiilename%7D/%E7%BD%91%E7%BB%9C%E6%98%AF%E6%80%8E%E6%A0%B7%E8%BF%9E%E6%8E%A5%E7%9A%84/image-20220913140803131.png" alt="image-20220913140803131"></p>
<h3 id="Web服务程序解释请求消息并做出相应"><a href="#Web服务程序解释请求消息并做出相应" class="headerlink" title="Web服务程序解释请求消息并做出相应"></a>Web服务程序解释请求消息并做出相应</h3><p>最简单的是按照请求方法+URI的HTML文件名获取</p>
<p>判断访问权限依据：客户端IP地址；客户端域名；用户名和密码</p>
<h3 id="浏览器接受响应消息并显示内容"><a href="#浏览器接受响应消息并显示内容" class="headerlink" title="浏览器接受响应消息并显示内容"></a>浏览器接受响应消息并显示内容</h3><p>按照Content-Type判断数据类型</p>
<p><img src="/imgs/$%7Bfiilename%7D/%E7%BD%91%E7%BB%9C%E6%98%AF%E6%80%8E%E6%A0%B7%E8%BF%9E%E6%8E%A5%E7%9A%84/image-20220913142737133.png" alt="image-20220913142737133"></p>
<p>charset&#x3D;urf-8表示文本编码方式</p>
<p>Content-Encoding表示压缩格式的具体转换方式</p>
<p>实际显示是浏览器负责对操作系统发出指令显示的</p>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ol>
<li>网络是怎样连接的 - 户根勤</li>
</ol>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://forthdifferential.github.io">陈锴烺</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://forthdifferential.github.io/2023/11/06/%E7%BD%91%E7%BB%9C%E6%98%AF%E6%80%8E%E6%A0%B7%E9%93%BE%E6%8E%A5%E7%9A%84/">https://forthdifferential.github.io/2023/11/06/%E7%BD%91%E7%BB%9C%E6%98%AF%E6%80%8E%E6%A0%B7%E9%93%BE%E6%8E%A5%E7%9A%84/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://forthdifferential.github.io" target="_blank">个人主页</a>！</span></div></div><div class="tag_share"><div class="post_share"><div class="social-share" data-image="/imgs/$%7Bfiilename%7D/%E7%BD%91%E7%BB%9C%E6%98%AF%E6%80%8E%E6%A0%B7%E8%BF%9E%E6%8E%A5%E7%9A%84/net_title.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/imgs/head.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">陈锴烺</div><div class="author-info__description">Every man is the master of his own fortune.</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">11</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/forthdifferential"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/forthdifferential" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:klchen_auto@163.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content"><center><b>---Welcome to my blog---<br></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E6%98%AF%E6%80%8E%E6%A0%B7%E8%BF%9E%E6%8E%A5%E7%9A%84"><span class="toc-text">网络是怎样连接的</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A2%E7%B4%A2%E6%B5%8F%E8%A7%88%E5%99%A8%E5%86%85%E5%AE%B9"><span class="toc-text">探索浏览器内容</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%9F%E6%88%90HTTP%E8%AF%B7%E6%B1%82%E6%B6%88%E6%81%AF"><span class="toc-text">生成HTTP请求消息</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#HTTP%E5%AE%9A%E4%B9%89%E4%BA%86%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%B8%8E%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B9%8B%E9%97%B4%E4%BA%A4%E4%BA%92%E7%9A%84%E6%B6%88%E6%81%AF%E5%86%85%E5%AE%B9%E5%92%8C%E6%AD%A5%E9%AA%A4%EF%BC%9A"><span class="toc-text">HTTP定义了客户端与服务器之间交互的消息内容和步骤：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%91DNS%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%9F%A5%E8%AF%A2Web%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84IP%E5%9C%B0%E5%9D%80"><span class="toc-text">向DNS服务器查询Web服务器的IP地址</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DNS%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%A4%A7%E6%8E%A5%E5%8A%9B"><span class="toc-text">DNS服务器大接力</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%9F%E5%90%8D%E5%B1%82%E6%AC%A1%E7%BB%93%E6%9E%84%EF%BC%9A"><span class="toc-text">域名层次结构：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%9F%A5%E8%AF%A2%E8%BF%87%E7%A8%8B%EF%BC%9A"><span class="toc-text">客户端查询过程：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%94%B6%E5%8F%91%E6%95%B0%E6%8D%AE%E7%9A%84%E6%93%8D%E4%BD%9C%EF%BC%9A"><span class="toc-text">收发数据的操作：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%A8%E7%94%B5%E4%BF%A1%E5%8F%B7%E4%BC%A0%E8%BE%93TCP-x2F-IP%E6%95%B0%E6%8D%AE%E2%80%94%E2%80%94%E5%8D%8F%E8%AE%AE%E6%A0%88%E5%92%8C%E7%BD%91%E5%8D%A1"><span class="toc-text">用电信号传输TCP&#x2F;IP数据——协议栈和网卡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%A5%97%E6%8E%A5%E5%AD%97"><span class="toc-text">创建套接字</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-text">连接服务器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%94%B6%E5%8F%91%E6%95%B0%E6%8D%AE"><span class="toc-text">收发数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%96%AD%E5%BC%80%E5%B9%B6%E5%88%A0%E9%99%A4%E5%A5%97%E6%8E%A5%E5%AD%97"><span class="toc-text">服务器断开并删除套接字</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IP%E5%92%8C%E4%BB%A5%E5%A4%AA%E7%BD%91%E7%9A%84%E5%8C%85%E6%94%B6%E5%8F%91%E6%93%8D%E4%BD%9C"><span class="toc-text">IP和以太网的包收发操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%85%E6%94%B6%E5%8F%91%E6%93%8D%E4%BD%9C"><span class="toc-text">包收发操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%A5%E5%A4%AA%E7%BD%91%E5%86%85MAC%E5%9C%B0%E5%9D%80%E6%9F%A5%E8%AF%A2%EF%BC%9A"><span class="toc-text">以太网内MAC地址查询：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BD%91%E5%8D%A1%E5%B0%86IP%E5%8C%85%E8%BD%AC%E5%8C%96%E6%88%90%E5%85%89%E7%94%B5%E4%BF%A1%E5%8F%B7%EF%BC%88%E6%B2%A1%E7%9C%8B%EF%BC%89"><span class="toc-text">网卡将IP包转化成光电信号（没看）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#UDP%E5%8D%8F%E8%AE%AE%E7%9A%84%E6%94%B6%E5%8F%91%E6%93%8D%E4%BD%9C"><span class="toc-text">UDP协议的收发操作</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BA%BF%E5%88%B0%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E2%80%94%E2%80%94%E9%9B%86%E7%BA%BF%E5%99%A8%E3%80%81%E4%BA%A4%E6%8D%A2%E6%9C%BA%E3%80%81%E8%B7%AF%E7%94%B1%E5%99%A8"><span class="toc-text">网线到网络设备——集线器、交换机、路由器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%A1%E5%8F%B7%E5%9C%A8%E7%BD%91%E7%BA%BF%E5%92%8C%E9%9B%86%E7%BA%BF%E5%99%A8%E4%B8%AD%E4%BC%A0%E8%BE%93"><span class="toc-text">信号在网线和集线器中传输</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%A4%E6%8D%A2%E6%9C%BA%E7%9A%84%E5%8C%85%E8%BD%AC%E5%8F%91"><span class="toc-text">交换机的包转发</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E5%99%A8%E7%9A%84%E5%8C%85%E8%BD%AC%E5%8F%91"><span class="toc-text">路由器的包转发</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E5%99%A8%E8%BD%AC%E5%8F%91%E5%8C%85%E8%BF%87%E7%A8%8B%EF%BC%9A"><span class="toc-text">路由器转发包过程：</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E5%99%A8%E6%8E%A5%E5%8F%97%E5%8C%85"><span class="toc-text">路由器接受包</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E8%B7%AF%E7%94%B1%E8%A1%A8%E7%A1%AE%E5%AE%9A%E8%BE%93%E5%87%BA%E7%AB%AF%E5%8F%A3"><span class="toc-text">查询路由表确定输出端口</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%89%BE%E4%B8%8D%E5%88%B0%E5%8C%B9%E9%85%8D%E8%B7%AF%E7%94%B1%E6%97%B6%E9%80%89%E6%8B%A9%E9%BB%98%E8%AE%A4%E8%B7%AF%E7%94%B1"><span class="toc-text">找不到匹配路由时选择默认路由</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E5%99%A8%E7%9B%B8%E5%85%B3%E5%B7%A5%E4%BD%9C"><span class="toc-text">路由器相关工作</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E5%99%A8%E7%9A%84%E5%8F%91%E9%80%81%E6%93%8D%E4%BD%9C"><span class="toc-text">路由器的发送操作</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E5%99%A8%E5%92%8C%E4%BA%A4%E6%8D%A2%E6%9C%BA"><span class="toc-text">路由器和交换机</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E5%99%A8%E7%9A%84%E9%99%84%E5%8A%A0%E5%8A%9F%E8%83%BD"><span class="toc-text">路由器的附加功能</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2"><span class="toc-text">地址转换</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A5%E5%85%A5%E7%BD%91%E5%92%8C%E7%BD%91%E7%BB%9C%E8%BF%90%E8%90%A5%E5%95%86"><span class="toc-text">接入网和网络运营商</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ADSL%E6%8E%A5%E5%85%A5%E7%BD%91%E7%9A%84%E7%BB%93%E6%9E%84%E5%92%8C%E5%B7%A5%E4%BD%9C%E6%96%B9%E5%BC%8F"><span class="toc-text">ADSL接入网的结构和工作方式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E7%A6%BB%E5%99%A8%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-text">分离器的作用</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%89%E7%BA%A4%E6%8E%A5%E5%85%A5%E7%BD%91"><span class="toc-text">光纤接入网</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#FTTH%E6%8A%80%E6%9C%AF"><span class="toc-text">FTTH技术</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A5%E5%85%A5%E7%BD%91%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%9A%84PPP%E5%92%8C%E9%9A%A7%E9%81%93"><span class="toc-text">接入网中使用的PPP和隧道</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E8%BF%90%E8%90%A5%E5%95%86%E7%9A%84%E5%86%85%E9%83%A8"><span class="toc-text">网络运营商的内部</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%A8%E8%B6%8A%E8%BF%90%E8%90%A5%E5%95%86%E7%9A%84%E7%BD%91%E7%BB%9C%E5%8C%85"><span class="toc-text">跨越运营商的网络包</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E7%9A%84%E5%B1%80%E5%9F%9F%E7%BD%91"><span class="toc-text">服务器端的局域网</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%85%E8%BF%87%E6%BB%A4%E6%96%B9%E5%BC%8F%EF%BC%88%E4%B8%BB%E6%B5%81%E9%98%B2%E7%81%AB%E5%A2%99%E6%96%B9%E5%BC%8F%EF%BC%89"><span class="toc-text">包过滤方式（主流防火墙方式）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E5%B0%86%E8%AF%B7%E6%B1%82%E5%B9%B3%E5%9D%87%E5%88%86%E9%85%8D%E7%BB%99%E5%A4%9A%E5%8F%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%9D%A5%E5%B9%B3%E8%A1%A1%E8%B4%9F%E8%BD%BD"><span class="toc-text">通过将请求平均分配给多台服务器来平衡负载</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E5%99%A8"><span class="toc-text">负载均衡器</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BC%93%E5%AD%98%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-text">缓存服务器</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%AD%A3%E5%90%91%E4%BB%A3%E7%90%86"><span class="toc-text">正向代理</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86"><span class="toc-text">反向代理</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%80%8F%E6%98%8E%E4%BB%A3%E7%90%86"><span class="toc-text">透明代理</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E5%AE%B9%E5%88%86%E5%8F%91%E6%9C%8D%E5%8A%A1"><span class="toc-text">内容分发服务</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E5%88%B0%E8%BE%BE%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%8C%E5%93%8D%E5%BA%94%E8%BF%94%E5%9B%9E%E6%B5%8F%E8%A7%88%E5%99%A8"><span class="toc-text">请求到达服务器，响应返回浏览器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF"><span class="toc-text">服务器的基本信息</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%A8%8B%E5%BA%8F"><span class="toc-text">服务器程序</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%8E%A5%E6%94%B6%E6%93%8D%E4%BD%9C"><span class="toc-text">服务器接收操作</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%8E%A5%E6%94%B6%E6%93%8D%E4%BD%9C%E7%9A%84%E5%85%A8%E8%BF%87%E7%A8%8B%E5%9B%9E%E9%A1%BE"><span class="toc-text">服务器接收操作的全过程回顾</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Web%E6%9C%8D%E5%8A%A1%E7%A8%8B%E5%BA%8F%E8%A7%A3%E9%87%8A%E8%AF%B7%E6%B1%82%E6%B6%88%E6%81%AF%E5%B9%B6%E5%81%9A%E5%87%BA%E7%9B%B8%E5%BA%94"><span class="toc-text">Web服务程序解释请求消息并做出相应</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8F%E8%A7%88%E5%99%A8%E6%8E%A5%E5%8F%97%E5%93%8D%E5%BA%94%E6%B6%88%E6%81%AF%E5%B9%B6%E6%98%BE%E7%A4%BA%E5%86%85%E5%AE%B9"><span class="toc-text">浏览器接受响应消息并显示内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="toc-text">参考资料</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/11/21/GFS%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/" title="分布式 - GFS论文阅读"><img src="/imgs/$%7Bfiilename%7D/GFS/image-20230411161308484.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="分布式 - GFS论文阅读"/></a><div class="content"><a class="title" href="/2023/11/21/GFS%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/" title="分布式 - GFS论文阅读">分布式 - GFS论文阅读</a><time datetime="2023-11-21T11:01:26.674Z" title="发表于 2023-11-21 19:01:26">2023-11-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/11/21/MapReduce%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/" title="分布式 - MapReduce论文阅读"><img src="/imgs/$%7Bfiilename%7D/MapReduce/image-20230329113648794.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="分布式 - MapReduce论文阅读"/></a><div class="content"><a class="title" href="/2023/11/21/MapReduce%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/" title="分布式 - MapReduce论文阅读">分布式 - MapReduce论文阅读</a><time datetime="2023-11-21T09:01:33.208Z" title="发表于 2023-11-21 17:01:33">2023-11-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/11/14/Mysql%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A%E8%AE%B0%E5%BD%95/" title="MySql - MySql必知必会记录"><img src="/imgs/$%7Bfiilename%7D/mysqlbizhibihui.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MySql - MySql必知必会记录"/></a><div class="content"><a class="title" href="/2023/11/14/Mysql%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A%E8%AE%B0%E5%BD%95/" title="MySql - MySql必知必会记录">MySql - MySql必知必会记录</a><time datetime="2023-11-14T13:39:06.803Z" title="发表于 2023-11-14 21:39:06">2023-11-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/11/14/MySql%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/" title="MySql - MySql数据库运行原理"><img src="/imgs/$%7Bfiilename%7D/Mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/title.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MySql - MySql数据库运行原理"/></a><div class="content"><a class="title" href="/2023/11/14/MySql%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/" title="MySql - MySql数据库运行原理">MySql - MySql数据库运行原理</a><time datetime="2023-11-14T07:44:37.544Z" title="发表于 2023-11-14 15:44:37">2023-11-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/11/14/Linux%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/" title="Linux - Linux网络编程"><img src="/imgs/$%7Bfiilename%7D/wangluobiancheng.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linux - Linux网络编程"/></a><div class="content"><a class="title" href="/2023/11/14/Linux%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/" title="Linux - Linux网络编程">Linux - Linux网络编程</a><time datetime="2023-11-14T07:12:13.923Z" title="发表于 2023-11-14 15:12:13">2023-11-14</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2023 By 陈锴烺</div><div class="footer_custom_text">I wish you to become your own sun, no need to rely on who's light.<p><a target="_blank" href="https://hexo.io/"><img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&logo=hexo" title="博客框架为Hexo"></a>&nbsp;<a target="_blank" href="https://butterfly.js.org/"><img src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&logo=bitdefender" title="主题采用butterfly"></a>&nbsp;<a target="_blank" href="https://www.jsdelivr.com/"><img src="https://img.shields.io/badge/CDN-jsDelivr-orange?style=flat&logo=jsDelivr" title="本站使用JsDelivr为静态资源提供CDN加速"></a> &nbsp;<a target="_blank" href="https://vercel.com/ "><img src="https://img.shields.io/badge/Hosted-Vervel-brightgreen?style=flat&logo=Vercel" title="本站采用双线部署，默认线路托管于Vercel"></a>&nbsp;<a target="_blank" href="https://vercel.com/ "><img src="https://img.shields.io/badge/Hosted-Coding-0cedbe?style=flat&logo=Codio" title="本站采用双线部署，联通线路托管于Coding"></a>&nbsp;<a target="_blank" href="https://github.com/"><img src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&logo=GitHub" title="本站项目由Gtihub托管"></a>&nbsp;<a target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&logo=Claris" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"></a></p></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"]):not([href="/music/"]):not([href="/no-pjax/"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>